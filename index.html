<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IronShield Defender - Professional System</title>
    <style>
        :root { --primary: #1a237e; --secondary: #d32f2f; --success: #2e7d32; }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #f0f4f8; margin: 0; padding: 0; }
        .app-container { max-width: 600px; margin: auto; background: white; min-height: 100vh; display: flex; flex-direction: column; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        .header { background: var(--primary); color: white; padding: 20px; text-align: center; }
        .step-panel { padding: 20px; display: none; flex-grow: 1; }
        .step-panel.active { display: block; }
        .card { background: #fff; border: 1px solid #ddd; border-radius: 10px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .title { font-weight: bold; color: var(--primary); display: block; margin-bottom: 15px; font-size: 18px; border-bottom: 2px solid #eee; padding-bottom: 5px; }
        .btn-row { padding: 20px; background: #f9f9f9; display: flex; gap: 10px; }
        button { flex: 1; padding: 15px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 16px; }
        .btn-next { background: var(--primary); color: white; }
        .btn-prev { background: #ccc; color: #333; }
        .btn-final { background: var(--success); color: white; }
        .member-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #eee; }
        /* Toggle Switch Style */
        .switch { position: relative; width: 45px; height: 22px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 20px; }
        input:checked + .slider { background-color: var(--success); }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider:before { transform: translateX(23px); }
    </style>
</head>
<body>

<div class="app-container">
    <div class="header">
        <h2 style="margin:0">IRONSHIELD DEFENDER</h2>
        <small>Smart Duty Roster Manager</small>
    </div>

    <div id="step1" class="step-panel active">
        <span class="title">1. ‡∑É‡∑è‡∂∏‡∑è‡∂¢‡∑í‡∂ö ‡∂Ω‡∑ê‡∂∫‡∑í‡∑É‡∑ä‡∂≠‡∑î‡∑Ä (Settings)</span>
        <div id="member-settings" class="card">
            <p style="font-size:13px; color:#666">‡∂∏‡∑ô‡∑Ñ‡∑í‡∂Ø‡∑ì ‡∂î‡∂∂‡∂ß ‡∑É‡∑è‡∂∏‡∑è‡∂¢‡∑í‡∂ö‡∂∫‡∂±‡∑ä ‡∂á‡∂≠‡∑î‡∑Ö‡∂≠‡∑ä ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∑Ñ‡∑ù ‡∂â‡∑Ä‡∂≠‡∑ä ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∂ö‡∑Ö ‡∑Ñ‡∑ê‡∂ö.</p>
            <div id="settings-list"></div>
        </div>
        <div class="btn-row">
            <button class="btn-next" onclick="nextStep(2)">‡∂¥‡∑ê‡∂∏‡∑í‡∂´‡∑ì‡∂∏ ‡∑É‡∂ß‡∑Ñ‡∂±‡∑ä ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∂ß (Next) ‚ûî</button>
        </div>
    </div>

    <div id="step2" class="step-panel">
        <span class="title">2. ‡∂Ö‡∂Ø ‡∂¥‡∑ê‡∂∏‡∑í‡∂´ ‡∑É‡∑í‡∂ß‡∑í‡∂± ‡∂Ö‡∂∫ (Attendance)</span>
        <div class="card" id="attendance-list">
            </div>
        <div class="btn-row">
            <button class="btn-prev" onclick="nextStep(1)">‡∂Ü‡∂¥‡∑É‡∑î</button>
            <button class="btn-next" onclick="nextStep(3)">‡∂©‡∑í‡∂∫‡∑î‡∂ß‡∑í ‡∂∂‡∑ô‡∂Ø‡∑è‡∂Ø‡∑ì‡∂∏‡∂ß (Next) ‚ûî</button>
        </div>
    </div>

    <div id="step3" class="step-panel">
        <span class="title">3. ‡∂ª‡∑è‡∂¢‡∂ö‡∑è‡∂ª‡∑í ‡∑É‡∑ä‡∂Æ‡∑è‡∂± (Duty Points)</span>
        <div id="point-assignment-list">
            </div>
        <div class="btn-row">
            <button class="btn-prev" onclick="nextStep(2)">‡∂Ü‡∂¥‡∑É‡∑î</button>
            <button class="btn-final" onclick="generateWhatsApp()">‡∂±‡∑í‡∂∏‡∑Ä‡∑è WhatsApp ‡∂∫‡∑Ä‡∂±‡∑ä‡∂± ‚ûî</button>
        </div>
    </div>
</div>

<script>
    // Data from your requirements
    const defaultMembers = ["OIC Asanka", "OIC Kumara", "SSO Tharaka", "SSO Jayalath", "JSO Lokubanda", "LOIC Rita", "LSO Nandani"];
    const points = ["Guard Room 01", "Guard Room 02", "Main Entrance", "Pharmacy Main", "CCTV New", "Main Gate"];

    function nextStep(step) {
        document.querySelectorAll('.step-panel').forEach(p => p.classList.remove('active'));
        document.getElementById('step' + step).classList.add('active');
        if(step === 2) renderAttendance();
        if(step === 3) renderPoints();
        window.scrollTo(0,0);
    }

    function renderAttendance() {
        const container = document.getElementById('attendance-list');
        container.innerHTML = "";
        defaultMembers.forEach(m => {
            container.innerHTML += `
                <div class="member-item">
                    <span>${m}</span>
                    <label class="switch">
                        <input type="checkbox" checked class="att-check" data-name="${m}">
                        <span class="slider"></span>
                    </label>
                </div>`;
        });
    }

    function renderPoints() {
        const present = Array.from(document.querySelectorAll('.att-check:checked')).map(el => el.dataset.name);
        const container = document.getElementById('point-assignment-list');
        container.innerHTML = "";
        
        points.forEach(p => {
            const last = localStorage.getItem('L_'+p) || "‡∂¥‡∑ô‡∂ª ‡∂Ø‡∂≠‡∑ä‡∂≠ ‡∂±‡∑ê‡∂≠";
            container.innerHTML += `
                <div class="card">
                    <div style="font-weight:bold; color:red">${p}</div>
                    <div style="font-size:11px; color:#999; margin-bottom:8px;">‡∂ö‡∂Ω‡∑í‡∂±‡∑ä ‡∑É‡∑í‡∂ß‡∑í‡∂∫‡∑ö: ${last}</div>
                    <select class="p-select" data-point="${p}" style="width:100%; padding:10px; border-radius:5px;">
                        <option value="">-- ‡∂±‡∑í‡∂Ω‡∂∞‡∑è‡∂ª‡∑í‡∂∫‡∑è ‡∂≠‡∑ù‡∂ª‡∂±‡∑ä‡∂± --</option>
                        ${present.map(m => `<option value="${m}" ${last !== m ? 'selected' : ''}>${m}</option>`).join('')}
                    </select>
                </div>`;
        });
    }

    function generateWhatsApp() {
        let msg = "*IRONSHIELD DEFENDER - DUTY ROSTER*\n\n";
        document.querySelectorAll('.p-select').forEach(s => {
            if(s.value) {
                msg += `üìç *${s.dataset.point}*: ${s.value}\n`;
                localStorage.setItem('L_'+s.dataset.point, s.value);
            }
        });
        window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`);
    }

    window.onload = () => nextStep(1);
</script>
</body>
</html>

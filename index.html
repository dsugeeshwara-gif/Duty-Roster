<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy Duty Setup v12.0</title>
    <style>
        :root { --primary: #2563eb; --dark: #1e293b; --bg: #f8fafc; --success: #22c55e; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); margin: 0; }
        .header { background: var(--dark); color: white; padding: 20px; text-align: center; position: sticky; top: 0; z-index: 100; }
        .container { padding: 20px; overflow-x: auto; }
        
        /* Search Bars */
        .search-container { display: flex; gap: 10px; margin-bottom: 20px; }
        input { padding: 12px; border: 1px solid #ddd; border-radius: 8px; flex: 1; font-size: 14px; }

        /* Grid Table */
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        th { background: #e2e8f0; padding: 12px; font-size: 12px; position: sticky; top: 80px; z-index: 10; border: 1px solid #cbd5e1; }
        td { border: 1px solid #e2e8f0; padding: 8px; text-align: center; }
        
        /* Cell Styles */
        .point-name { text-align: left; font-weight: bold; background: #f8fafc; min-width: 180px; position: sticky; left: 0; z-index: 5; border-right: 2px solid #cbd5e1; }
        .cell-check { width: 40px; height: 40px; cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        .cell-check.active { background: #dcfce7; color: var(--success); font-weight: bold; }
        .cell-check:hover { background: #eff6ff; }

        .btn-view { position: fixed; bottom: 20px; right: 20px; background: var(--primary); color: white; padding: 15px 30px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; box-shadow: 0 10px 15px rgba(37, 99, 235, 0.3); }
    </style>
</head>
<body>

<div class="header">
    <h2 style="margin:0;">Duty Allocation Matrix</h2>
    <p style="margin:5px 0 0; font-size:12px; opacity:0.8;">පොයින්ට් එක සහ සේවකයා හමුවන කොටුව මත ක්ලික් කර සලකුණු කරන්න</p>
</div>

<div class="container">
    <div class="search-container">
        <input type="text" id="pointSearch" placeholder="පොයින්ට් එකක් සොයන්න (Search Point...)" oninput="renderTable()">
        <input type="text" id="staffSearch" placeholder="සේවකයෙක් සොයන්න (Search Staff...)" oninput="renderTable()">
    </div>

    <table id="matrixTable">
        <thead id="tableHead"></thead>
        <tbody id="tableBody"></tbody>
    </table>
</div>

<button class="btn-view" onclick="alert('රාජකාරි වගුව සූදානම්!')">View Roster</button>

<script>
    const points = ["Guard Room - Post 01", "Guard Room - Post 02", "M/E Entry - 01", "M/E Entry - 02", "Time Office", "B/C/P - Post 01", "B/C/P - Post 02", "Glass Door", "Lobby - Post 01", "Lobby - Post 02", "C/P/R", "Doctors' Lift", "Pharmacy - Main", "Pharmacy - OPD", "Pharmacy - Helper", "CCTV New - 01", "CCTV New - 02", "C/P/03", "C/P/04", "Commercial Hostel", "Rounds - 01", "Rounds - 02", "Kitchen Stores", "Kitchen", "Main Gate", "2nd Basement", "SICU", "MICU", "CCTV Old - 01", "CCTV Old - 02", "Lift Lobby - 3rd Floor", "Lift Lobby - 4th Floor", "Lift Lobby - 5th Floor", "Lift Lobby - 6th Floor", "Fort City", "Lady Hostel - New", "Hostal - Old", "Hostal - New", "Layanal Area", "Bambalapitiya Area", "Dilan Area", "Receiving"];

    const staff = ["OIC අසංක", "OIC කුමාර", "OIC සුරංජිත්", "OIC සමරනායක", "OIC දයාරත්න", "OIC සුරේෂ්", "OIC මෙන්ඩිස්", "OIC විජිතලාල්", "OIC රංගන", "SSO තාරක", "SSO ජයලත්", "SSO විරේශ්", "SSO රවී", "SSO අජිත්", "SSO මනූෂ", "SSO රත්නදාස", "LOIC රීටා", "LOIC මල්කාන්ති", "JSO ප්‍රසන්න", "JSO ප්‍රදීප්", "JSO චන්දන", "JSO විජේරත්න", "JSO රාජ්", "JSO දිනේෂ්", "JSO රවිඳු", "JSO ලොකුබංඩා", "JSO සුනිල්", "JSO සම්පත්", "LSO සීලවතී", "LSO නාලනී", "LSO විමලසූරිය", "LSO නන්දනී", "LSO නන්දලතා", "LSO ඩිලානි", "LSO ශ්‍රියාලතා", "LSO ශාන්ති", "LSO නුගවෙල", "LSO චම්පිකා", "LSO පෙරේරා"];

    let db = JSON.parse(localStorage.getItem('matrix_db_v12')) || {};

    function renderTable() {
        const pSearch = document.getElementById('pointSearch').value.toLowerCase();
        const sSearch = document.getElementById('staffSearch').value.toLowerCase();
        
        const head = document.getElementById('tableHead');
        const body = document.getElementById('tableBody');

        // Filter Staff
        const filteredStaff = staff.filter(s => s.toLowerCase().includes(sSearch));
        // Filter Points
        const filteredPoints = points.filter(p => p.toLowerCase().includes(pSearch));

        // Header
        head.innerHTML = `<tr><th class="point-name">Point Name</th>${filteredStaff.map(s => `<th>${s}</th>`).join('')}</tr>`;

        // Body
        body.innerHTML = filteredPoints.map(p => `
            <tr>
                <td class="point-name">${p}</td>
                ${filteredStaff.map(s => {
                    const isActive = db[p] && db[p].includes(s);
                    return `<td class="cell-check ${isActive ? 'active' : ''}" onclick="toggleCell('${p}', '${s}')">${isActive ? '✓' : ''}</td>`;
                }).join('')}
            </tr>
        `).join('');
    }

    function toggleCell(p, s) {
        if (!db[p]) db[p] = [];
        if (db[p].includes(s)) {
            db[p] = db[p].filter(name => name !== s);
        } else {
            db[p].push(s);
        }
        localStorage.setItem('matrix_db_v12', JSON.stringify(db));
        renderTable();
    }

    renderTable();
</script>
</body>
</html>
